# ═══════════════════════════════════════════════════════════════
#  Real GCS Testing Environment
# ═══════════════════════════════════════════════════════════════
#
# This configuration uses real Google Cloud Storage for testing
# Service Account: dev-mish@dss-infra-terraform-admin.iam.gserviceaccount.com
#

# ───────────────────────────────────────────────────────────────
#  GCS Configuration (Real Google Cloud Storage)
# ───────────────────────────────────────────────────────────────

GCS_PROJECT_ID=erlich-dev
GCS_BUCKET_NAME=formio-test-uploads-erlich
GOOGLE_APPLICATION_CREDENTIALS=/app/gcs-credentials.json

# Use real GCS (not emulator)
FORMIO_FILES_SERVER=gcs
FORMIO_S3_SERVER=https://storage.googleapis.com
FORMIO_S3_BUCKET=formio-test-uploads-erlich
FORMIO_S3_REGION=us-central1

# ───────────────────────────────────────────────────────────────
#  MongoDB Configuration
# ───────────────────────────────────────────────────────────────

MONGO_DB_NAME=formioapp_gcs_test

# ───────────────────────────────────────────────────────────────
#  Form.io Server Configuration
# ───────────────────────────────────────────────────────────────

FORMIO_PORT=3001
NODE_ENV=test

# Secrets (test environment)
JWT_SECRET=test-jwt-secret-gcs-integration
DB_SECRET=test-db-secret-gcs-integration

# Admin Credentials
ROOT_EMAIL=admin@gcs-test.local
ROOT_PASSWORD=admin123

# CORS Configuration
CORS_ORIGIN=http://localhost:64849,http://localhost:3000

# Logging
DEBUG=formio:*,formio:gcs:*,formio:upload:*

# Rate Limiting (disabled for testing)
DISABLE_RATE_LIMIT=true

# ───────────────────────────────────────────────────────────────
#  GCS Async Upload Configuration
# ───────────────────────────────────────────────────────────────

# Enable async upload with BullMQ job queue
ENABLE_ASYNC_GCS_UPLOAD=true

# Number of concurrent upload workers (increased for testing)
BULLMQ_WORKER_CONCURRENCY=5

# Redis Configuration
REDIS_HOST=redis
REDIS_PORT=6379

# ───────────────────────────────────────────────────────────────
#  TUS Server Configuration
# ───────────────────────────────────────────────────────────────

TUS_PORT=1080
TUS_MAX_SIZE=5368709120  # 5GB

# ═══════════════════════════════════════════════════════════════
#  USAGE
# ═══════════════════════════════════════════════════════════════
#
# Start with real GCS:
#   docker-compose --env-file .env.real-gcs up -d
#
# Run tests:
#   cd formio && bun test src/upload/__tests__/integration-real-gcs.test.js
#   cd test-app && bun run test:e2e tests/e2e/gcs-upload.spec.ts
#
# ═══════════════════════════════════════════════════════════════
